# Tasks

**Context:** Нужно добавить и настроить Supabase в проект на стороне сервера. Добавить env example и тд. Настроить минимально.

## Main directions

### Установка зависимостей

- [ ] Установить пакет `@supabase/supabase-js` в зависимости проекта. Проверить, что пакет добавлен в `package.json` в секции `dependencies`.

### Конфигурация переменных окружения

- [ ] Создать файл `.env.example` в корне проекта с примерами переменных `SUPABASE_URL` и `SUPABASE_SERVICE_ROLE_KEY` с комментариями о том, где их получить. Проверить, что файл содержит только примеры без реальных ключей.

- [ ] Проверить наличие `.env` в `.gitignore`. Если отсутствует, добавить `.env` в `.gitignore`. Убедиться, что реальные секреты не попадут в репозиторий.

### Инициализация Supabase клиента на сервере

- [ ] Создать серверный plugin или utility для инициализации Supabase клиента. Клиент должен создаваться один раз при старте сервера и быть доступен в server-side контексте. Проверить, что используется `SUPABASE_URL` и `SUPABASE_SERVICE_ROLE_KEY` из переменных окружения.

- [ ] Реализовать проверку наличия обязательных переменных окружения при инициализации. При отсутствии переменных логировать предупреждение. Проверить логирование при отсутствии переменных.

- [ ] Обеспечить доступность клиента в server API routes (например, в `server/api/`). Проверить, что клиент можно использовать в существующих или новых API endpoints.

- [ ] Добавить TypeScript типизацию для Supabase клиента. Проверить, что TypeScript не выдает ошибок при использовании клиента.

### Тестирование

- [ ] Протестировать инициализацию клиента при наличии всех переменных окружения. Проверить, что клиент успешно создается и доступен.

- [ ] Протестировать поведение при отсутствии переменных окружения. Проверить, что приложение логирует предупреждение и не падает с критической ошибкой.

## Supporting tasks

- [ ] Документация: добавить комментарии в код о том, как использовать Supabase клиент в серверных API routes. Обновить README.md с инструкциями по настройке переменных окружения из `.env.example`.

- [ ] Observability: обеспечить логирование успешной инициализации Supabase клиента (опционально, для отладки). Добавить логирование ошибок при проблемах с подключением.

- [ ] Code review and PR: подготовить изменения для review. Убедиться, что все файлы соответствуют стандартам проекта и нет линтер ошибок.

## Definition of Done

- [ ] Все задачи выполнены и протестированы.
- [ ] Переменные окружения настроены и проверены (через `.env.example`).
- [ ] Supabase клиент инициализируется на сервере и доступен в API routes.
- [ ] TypeScript типы работают корректно без ошибок.
- [ ] Логирование работает при отсутствии переменных окружения.
- [ ] Файл `.env` добавлен в `.gitignore`.
- [ ] Документация обновлена с инструкциями по настройке.
- [ ] `/spec/core/verify.md` выполнен после завершения всех задач для проверки списка задач.

