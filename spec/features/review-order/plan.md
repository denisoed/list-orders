# Implementation Plan

**Plan:** Реализовать новый экран отправки заказа на проверку и обновить навигацию с карточки заказа. Использовать существующие компоненты интерфейса, обеспечить обработку загрузки фотографий и комментариев, а также визуальное сокращение длинных имен файлов.

## Data sources / schemas
- Проверить доступные API/сторы для получения деталей заказа (название, статус) и возможности обновления статуса до «ожидает проверки».
- Уточнить и при необходимости расширить схему данных для хранения вложенных фотографий и комментария (использовать текущий механизм хранения файлов).
- Убедиться, что фронтенд поддерживает множественные загрузки изображений и ссылки на сохранённые файлы.

## Contracts and interfaces
- Определить маршрут страницы, например `/orders/[id]/review`, и согласовать параметры навигации из деталей заказа.
- Обновить контракт действия «Отметить выполненным», чтобы он инициировал переход на новую страницу вместо мгновенного изменения статуса.
- Согласовать формат передачи файлов и комментария при отправке (например, multipart/form-data или JSON с ссылками на заранее загруженные файлы).
- Обеспечить отображение ошибок загрузки и сохранения в едином стиле уведомлений.

## Architecture / Components
- Создать компонент страницы отправки на проверку с шапкой, кнопкой «Назад» и названием задачи (переиспользовать хедер из списка заказов).
- Добавить компонент для загрузки фотографий, поддерживающий обрезку длинных названий (функция форматирования имени файла).
- Интегрировать текстовое поле комментария и кнопку отправки, используя существующие UI-компоненты.
- Настроить логику сохранения: загрузка файлов (при необходимости — предварительное сохранение) и отправка запроса изменения статуса.
- Реализовать переход назад по кнопке, возвращающий пользователя к деталям заказа.

## Risks
- Возможные ограничения бэкенда по количеству/размеру загружаемых файлов могут привести к ошибкам сохранения.
- Недоступность повторного использования хедера может потребовать дублирования стилей или временного решения.
- Некорректная обработка длинных имен файлов может вызвать разметку, выходящую за пределы контейнера.

## Assumptions
- Бэкенд уже поддерживает состояние заказа «ожидает проверки» и хранение комментариев и медиа.
- Маршрут и данные заказа доступны через Nuxt-роутер и сторы проекта.
- В проекте уже есть компонент уведомлений для отображения ошибок/успеха.

## Implementation summary (2025-11-03)
- Создан подмаршрут `/orders/[id]/review` с отдельной страницей отправки заказа на проверку, использующей базовый хедер и минималистичный интерфейс.
- Действие «Отметить выполненным» на странице деталей (`pages/orders/[id]/index.vue`) перенаправляет на новый экран вместо мгновенной смены статуса.
- Добавлен модуль `utils/orderReviewSubmission.ts`, имитирующий загрузку вложений и перевод заказа в статус `pending-review` до интеграции с бэкендом.
- На клиенте реализовано обрезание длинных имён файлов с троеточием и отзыв предварительных превью при очистке списка вложений.
